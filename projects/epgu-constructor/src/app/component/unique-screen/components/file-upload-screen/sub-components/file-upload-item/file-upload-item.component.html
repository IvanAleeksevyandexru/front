<div class="fileupload__wrapper">
  <div *ngIf="data.title" class="title">
    {{ data.title }}
    <epgu-constructor-user-info-loader [isDisplay]="false"></epgu-constructor-user-info-loader>
  </div>
  <div class="file__bottom">
    <epgu-constructor-output-html
      class="info__text"
      [html]="data.label"
      [clarifications]="clarification"
    >
    </epgu-constructor-output-html>
    <div *ngIf="refData?.length" class="fileupload__label" [innerHTML]="refData"></div>
  </div>
  <div *ngIf="files | async as files" class="files">
    <div *ngFor="let file of files" class="file">
      <div
        class="file__icon"
        [class.uploaded]="file.status === 'uploaded'"
        [class.loading]="file.status !== 'uploaded'"
      ></div>
      <div class="file__title-wrapper">
        <div
          *ngIf="file.status === 'uploaded'"
          class="file__title uploaded"
          [innerText]="file?.item?.fileName || file?.raw?.name"
          (click)="downloadFile(file)"
        ></div>
        <span *ngIf="file.status !== 'uploaded'" class="file__title">
          Файл загружается...
        </span>
        <div *ngIf="file.status === 'uploaded'" class="file__title-info">
          Файл загружен ({{ file?.item?.fileSize || file?.raw?.size }})
        </div>
      </div>
      <button *ngIf="file.status === 'uploaded'" class="file__action" (click)="deleteFile(file)">
        Удалить
      </button>
    </div>
  </div>

  <epgu-constructor-uploader-manager></epgu-constructor-uploader-manager>
  <epgu-constructor-uploader (upload)="updateSelectedFilesInfoAndSend($event)">
    <div class="uploader-info">
      <span *ngIf="!isMobile">Перетащите файлы или выберите на компьютере</span>
      <span *ngIf="isMobile">Выберите файл или сделайте фото</span>
    </div>
    <div class="uploader-buttons">
      <epgu-constructor-uploader-button capture="environment" accept="image/*">
        <button
          *ngIf="this.isMobile"
          [disabled]="isButtonsDisabled"
          class="fileupload__link-button"
        >
          <img
            src="{{ config.staticDomainAssetsPath }}/assets/icons/svg/camera.svg"
            class="fileupload__button-icon"
            alt="Фото"
          />
          Сделать фото
        </button>
      </epgu-constructor-uploader-button>
      <epgu-constructor-uploader-button [multiple]="true" [accept]="getAcceptTypes()">
        <button [disabled]="isButtonsDisabled" class="fileupload__link-button">
          <img
            src="{{ config.staticDomainAssetsPath }}/assets/icons/svg/clip.svg"
            class="fileupload__button-icon"
            alt="Файл"
          />
          Выбрать ещё
        </button>
      </epgu-constructor-uploader-button>
    </div>
  </epgu-constructor-uploader>
  <div *ngIf="errors.length">
    <div *ngFor="let error of errors" class="error">
      <div class="file__icon has-error"></div>
      <span>{{ error }}</span>
    </div>
  </div>
</div>
