<epgu-constructor-screen-container
  [show-nav]="screenService.showNav$ | async"
  [class.screen-container-mt]="!(screenService.showNav$ | async)"
>
  <div class="screen-body quiz__content">
    <epgu-constructor-page-name class="quiz__head">
      {{ screenService.header$ | async }}
      <epgu-constructor-user-info-loader></epgu-constructor-user-info-loader>
    </epgu-constructor-page-name>
    <epgu-constructor-output-html
      class="quiz__text"
      *ngIf="screenService.component?.label"
      [html]="screenService.component?.label | imgPrefixer"
      [clarifications]="screenService.component?.attrs?.clarifications"
    >
    </epgu-constructor-output-html>
    <ng-container *ngIf="rejectAction">
      <ng-content *ngTemplateOutlet="actionAsLongBtn"></ng-content>
    </ng-container>
  </div>

  <div class="screen-footer">
    <ng-container *ngIf="isActionsAsLongBtsShown">
      <ng-content *ngTemplateOutlet="actionAsLongBtn"></ng-content>
    </ng-container>
    <ng-container *ngIf="isAnswersAsLongBtsShown">
      <ng-content *ngTemplateOutlet="answerAsLongBtn"></ng-content>
    </ng-container>
    <ng-container *ngIf="rejectAction">
      <ng-content *ngTemplateOutlet="footerActionAndSubmit"></ng-content>
    </ng-container>
    <ng-container *ngIf="screenActionButtons.length">
      <ng-container *ngTemplateOutlet="screenActionBtns"></ng-container>
    </ng-container>
  </div>
</epgu-constructor-screen-container>

<!-- TODO: удалить после переезда на механизм явных answers -->
<ng-template #actionAsLongBtn>
  <div class="quiz__answers">
    <ng-container *ngFor="let action of componentActions; let idx = index">
      <epgu-constructor-answer-button
        [tabindex]="idx + 1"
        [data]="action"
        class="quiz__answer"
        [selectedValue]="selectedAnswer"
        *ngIf="showAnswerAsLongBtn(action)"
        (click)="answerChoose(action)"
        (keydown.enter)="answerChoose(action)"
        (keydown.space)="answerChoose(action)"
      >
      </epgu-constructor-answer-button>
    </ng-container>
  </div>
</ng-template>

<ng-template #answerAsLongBtn>
  <div class="quiz__answers">
    <ng-container *ngFor="let answer of componentAnswers; let idx = index">
      <epgu-constructor-answer-button
        [tabindex]="idx + 1"
        [data]="answer"
        class="quiz__answer"
        [selectedValue]="selectedAnswer"
        *ngIf="showAnswerAsLongBtn(answer)"
        (click)="answerChoose(answer)"
        (keydown.enter)="answerChoose(answer)"
        (keydown.space)="answerChoose(answer)"
      >
      </epgu-constructor-answer-button>
    </ng-container>
  </div>
</ng-template>

<!-- TODO: переделать на прямой проброс всех actions после переезда на механизм явных answers -->
<ng-template #footerActionAndSubmit>
  <lib-button color="white"
    epgu-constructor-action
    [action]="rejectAction"
  >
    {{ rejectAction.label }}
  </lib-button>
  <lib-button
    *ngIf="submitLabel"
    [showLoader]="screenService.isLoading$ | async"
    epgu-constructor-action
    [action]="nextStepAction"
    class="submit-button"
    data-testid="submit-btn"
  >
    {{ submitLabel }}
  </lib-button>
</ng-template>

<ng-template #screenActionBtns>
  <lib-button
    *ngFor="let action of screenActionButtons"
    epgu-constructor-action
    [action]="action"
    [color]="action.color"
  >
    <div>{{ action.label }}</div>
  </lib-button>
</ng-template>
