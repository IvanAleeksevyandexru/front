<div class="widget">
  <epgu-constructor-search-panel-resolver
    [panelType]="searchPanelType"
    [label]="data.label"
    [disclaimer]="data.attrs.disclaimer"
    [showNav]="screenService.showNav$ | async"
    [noDepartmentsErrorMsg]="data.attrs.noDepartmentsErrorMsg"
    [isNoDepartmentErrorVisible]="isNoDepartmentErrorVisible"
  ></epgu-constructor-search-panel-resolver>
  <lib-map
    *ngIf="showMap"
    [externalMode]="!config.staticDomainAssetsPath"
    [enterpriseYandexMapsEnabled]="true"
    [yandexMapsApiKey]="config.yandexMapsApiKey"
    [center]="mapCenter"
    [redraw]="selectMapObjectService.isMapLoaded.getValue()"
    [controls]="mapControls"
    [zoom]="data.attrs.mapOptions?.initZoom"
  >
  </lib-map>
  <div
    *ngIf="selectedValue"
    class="map-objects-list"
    [ngClass]="{ 'fixed-height': selectedValue && selectedValue.children?.length > 1 && !isMobile}"
  >
    <perfect-scrollbar [config]="scrollConfig" class="perfect-scrollbar">
      <ng-container *ngTemplateOutlet="contentBlock"></ng-container>
    </perfect-scrollbar>
    <ng-template #contentBlock>
      <div class="cross-btn" (click)="yandexMapService.closeBalloon()"></div>
      <ng-container *ngFor="let mapObject of selectedValue">
        <epgu-constructor-balloon-content-resolver
          [contentType]="balloonContentType"
          [mapObject]="mapObject"
          [isSelectButtonHidden]="data.attrs.isSelectButtonHidden"
          [attrs]="data.attrs.balloonAttrs"
          (selectObject)="selectObject($event)"
        >
        </epgu-constructor-balloon-content-resolver>
      </ng-container>
    </ng-template>
  </div>
</div>
