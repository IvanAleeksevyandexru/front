image: node:latest

cache:
  paths: 
    - node_modules
    - dist
    - .yarn
      
stages:
  - install
  - lint
  - library-build
  - build

Install:
  stage: install
  before_script:
    - yarn config set cache-folder .yarn
    - npm set registry http://npm.gosuslugi.local
  script: 
    - yarn install

Lint:
  stage: lint
  before_script:
    - yarn config set cache-folder .yarn  
  script: 
    - yarn lint

#Test:
#  stage: test
#  before_script:
#    - yarn config set cache-folder .yarn
#  script: 
#    - yarn test --coverage
    
Library-build:
  stage: library-build
  before_script:
    - yarn config set cache-folder .yarn 
  script: 
    - yarn library-build

Build:
  stage: build
  before_script:
    - yarn config set cache-folder .yarn 
  script: 
    - yarn build